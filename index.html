function generatePresentation() {
  const text = document.getElementById("outlineText").value;
  if (!text.trim()) {
    alert("Please paste text or upload a file.");
    return;
  }
  const pptx = new PptxGenJS();
  const logoUrl = "https://beadbeed3000.github.io/slidebot/assets/logo.png";
// ... then, in addImage:
slide.addImage({
  path: logoUrl,
  x: 9.2, y: 6.5, w: 1.2, h: 0.6
});


  // This regex finds "I.", "II.", ... or "A.", "B.", ... at the start of a line (case sensitive)
  const slideBreakRegex = /^([IVXLCDM]+\.|[A-Z]\.)\s+(.*)/gm;

  let match;
  let slides = [];
  let lastIndex = 0;
  let currentSlide = null;

  while ((match = slideBreakRegex.exec(text)) !== null) {
    if (currentSlide) {
      currentSlide.content = text.substring(lastIndex, match.index).trim();
      slides.push(currentSlide);
    }
    currentSlide = {
      title: match[0].trim(),
      cleanTitle: match[2].trim(),
      start: match.index,
      end: slideBreakRegex.lastIndex,
      content: "" // to be filled in next loop
    };
    lastIndex = match.index + match[0].length;
  }
  if (currentSlide) {
    currentSlide.content = text.substring(lastIndex).trim();
    slides.push(currentSlide);
  }

  // Now, generate slides
  slides.forEach(slideObj => {
    const slide = pptx.addSlide();
    slide.background = { color: 'F1F1F1' };
    slide.addText(slideObj.cleanTitle, {
      x: 0.5, y: 0.3, fontSize: 28, bold: true, color: '0F60AD',
      align: 'center', w: '90%', h: 1
    });

    // Split content into bullets (split by newline, remove empty lines)
    const bullets = slideObj.content
      .split('\n')
      .map(line => line.trim())
      .filter(Boolean);

    if (bullets.length > 0) {
      slide.addText(bullets, {
        x: 0.75, y: 1.2, w: 8.5, h: 5.5, fontSize: 18, bullet: true,
        color: '333333', fontFace: 'Arial'
      });
    }

    slide.addShape(pptx.ShapeType.rect, {
      x: 0, y: 6.7, w: '100%', h: 0.3,
      fill: { color: '71AC4A' }
    });

    slide.addImage({
      path: logoUrl,
      x: 9.2, y: 6.5, w: 1.2, h: 0.6
    });
  });

  pptx.writeFile("Generated_Presentation.pptx");
}
